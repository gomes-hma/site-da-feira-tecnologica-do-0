<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CAS: Jogo</title>
    <link rel="shortcut icon" href="imgs/favicon.png" type="image/x-icon">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Emblema+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Buenard:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="CssExterno/site-da-feira-tecnologica-do-0/style.css">
    <link rel="stylesheet" href="bootstrap-5.3.8-dist\css\bootstrap.css">

    
    <style>
        :root {
            --lilac: #9599E6;
            --lilac-dark: #6e71a9;
            --dark-purple: #23252F;
            --light: #fffdf6;
        }

        .bg-lilac {
            background-color: var(--lilac) !important;
        }

        .bg-dark-purple {
            background-color: var(--dark-purple) !important;
        }

        .border-lilac {
            border-color: var(--lilac) !important;
        }

        .text-lilac {
            color: var(--lilac) !important;
        }

        .btn-lilac {
            background-color: var(--lilac);
            border-color: var(--lilac);
            color: var(--dark-purple);
        }

        .btn-lilac:hover {
            background-color: var(--lilac-dark);
            border-color: var(--lilac-dark);
            color: var(--light);
        }

        .btn-outline-lilac {
            color: var(--lilac);
            border-color: var(--lilac);
            background-color: transparent;
        }

        .btn-outline-lilac:hover {
            background-color: var(--lilac);
            color: var(--dark-purple);
        }

        .alert-lilac {
            background-color: rgba(149, 153, 230, 0.2);
            border-color: var(--lilac);
            color: var(--light);
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            background-color: #23252F;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            z-index: 999;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        /* Logo */
        .logo {
            width: auto;
            cursor: pointer;
            transition: color 0.3s;
            padding: 5%;
            height: 60px;
        }

        /* Nav */
        nav {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        nav a {
            text-decoration: none;
            color: #fffdf6;
            font-weight: 500;
            font-size: 0.95em;
            position: relative;
            transition: color 0.3s;
            padding-bottom: 5px;
            font-family: "Buenard", serif;
            font-optical-sizing: auto;
            font-weight: 800;
            font-style: normal;
        }

        nav a:hover {
            color: #9599E6;
        }

        /* Indicador de Página Ativa */
        nav a.active {
            color: #6e71a9;
            border-bottom: 3px solid #6e71a9;
        }

        /* Botão Menu Sanduíche (Hamburger) */
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            gap: 5px;
            padding: 5px;
            z-index: 1001; /* Garante que fique acima do menu mobile */
            background: none;
            border: none;   
            width: 35px;
            height: 35px;
            justify-content: center;
            align-items: center;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background-color: #fffdf6;
            border-radius: 2px;
            transition: all 0.3s ease;
            display: block;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(8px, 8px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(8px, -8px);
        }

        /* Menu Mobile */
        .nav-mobile {
            display: none;
            position: fixed;
            top: 70px;
            left: 0;
            width: 100%;
            background-color: #23252fbb;
            flex-direction: column;
            gap: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            z-index: 1000; /* Garante que fique acima do conteúdo */
        }

        .nav-mobile.active {
            max-height: 500px; /* Ajuste conforme necessário */
        }

        .nav-mobile a {
            display: block;
            padding: 15px 20px;
            text-decoration: none;
            color: #fffdf6;
            font-weight: 500;
            border-bottom: 1px solid #eee;
            transition: background-color 0.3s, color 0.3s;
            cursor: pointer;
        }

        .nav-mobile a:hover {
            color: #9599E6;
        }

        .nav-mobile a.active {
            color: #3d3f5d;

            padding-left: 16px;
        }


        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            /* fica atrás de todo o conteúdo */
            overflow: hidden;
        }



        /* Base e Tipografia do Jogo */
        #game-container * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Buenard', serif;
        }

        .titulo {
            font-family: "Emblema One", system-ui;
            color: #9599E6;
            font-size: 2em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        /* Container Principal do Jogo */
        #game-container {
            width: 90%;
            max-width: 600px;
            padding: 30px;
            background: rgba(35, 37, 47, 0.95);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(149, 153, 230, 0.15);
            text-align: center;
            margin: 50px auto;
            color: #fffdf6;
        }

        #countdown {
            font-size: 1.5rem;
            color: #9599E6;
            font-weight: bold;
        }

        .event-card {
            background: rgba(55, 57, 67, 0.95);
            padding: 25px;
            border-radius: 10px;
            border: 1px solid rgba(149, 153, 230, 0.2);
        }

        #event-text {
            font-size: 1.2rem;
            color: #fffdf6;
            line-height: 1.6;
        }

        .btn-outline-secondary {
            color: #9599E6;
            border-color: #9599E6;
            background: transparent;
            transition: all 0.3s ease;
        }

        .btn-outline-secondary:hover {
            background-color: #9599E6;
            color: #23252F;
        }

        .btn-primary {
            background-color: #9599E6;
            border-color: #9599E6;
            color: #23252F;
        }

        .btn-primary:hover {
            background-color: #6e71a9;
            border-color: #6e71a9;
        }

        #success-message {
            background-color: rgba(149, 153, 230, 0.2);
            border-color: #9599E6;
            color: #fffdf6;
        }

        /* Tela de Início e Botões do Jogo */
        #start-screen,
        #result-screen {
            padding: 20px 0;
        }

        #game-container button {
            background-color: var(--title);
            color: var(--text-darker);
            border: none;
            padding: 12px 25px;
            margin-top: 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.2s ease, transform 0.1s ease;
        }

        #game-container button:hover {
            background-color: var(#9599E6);
            transform: translateY(-2px);
        }

        /* Indicador de Tempo */
        #countdown {
            font-size: 1.5em;
            font-weight: bold;
            color: var(--lilac-3);
            margin-bottom: 20px;
        }

        /* Estilo das Barras de Recurso */
        .resource-bar-container {
            text-align: left;
            margin-bottom: 15px;
        }

        .resource-bar-container label {
            font-size: 0.9em;
            color: var(--lilac-3);
        }

        .bar-outer {
            height: 25px;
            background-color: var(--text-dark);
            border-radius: 12px;
            overflow: hidden;
            margin-top: 5px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        .bar-inner {
            height: 100%;
            transition: width 0.3s ease-out, background-color 0.5s ease;
        }

        /* Cores Iniciais das Barras */
        #em-bar {
            background-color: var(--lilac-1);
            /* Energia Mental: Lilás */
        }

        #de-bar {
            background-color: var(--color-danger);
            /* Dívida Emocional: Vermelho-Alerta */
        }

        /* Área de Evento/Notificação */
        .event-card {
            background-color: var(--text-dark);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        #event-text {
            font-size: 1.2em;
            margin-bottom: 20px;
        }

        .options {
            display: flex;
            justify-content: space-around;
            gap: 10px;
        }

        .options button {
            flex-grow: 1;
            margin: 0;
            font-size: 1em;
        }

        .sacrifice-btn {
            background-color: var(--text-dark);
            /* Fica mais escuro */
            border: 1px solid var(--lilac-2);
            color: var(--lilac-2);
        }

        .sacrifice-btn:hover {
            background-color: var(--text-darker);
        }

        .courage-btn {
            background-color: var(--lilac-3);
            /* Cor de alívio */
            color: var(--text-darker);
        }

        .courage-btn:hover {
            background-color: var(--lilac-1);
        }

        /* Efeito de Ruído (Quando Dívida é Alta) */
        /* O efeito de shake no body foi removido do estilo do jogo,
           pois pode afetar a página inteira, mas o efeito de cor do fundo do body.overload
           pode ser re-aplicado a #game-container, se o estilo original do site permitir.
           Vou manter a lógica 'overload' no JS, mas a classe CSS para o body será ignorada aqui.
        */

        /* Tela de Resultado */
        .result-card {
            min-height: 250px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        #result-message {
            font-size: 1.1em;
            color: var(--lilac-3);
        }

        .cta-area {
            margin: 20px 0;
        }

        .cta-link {
            color: var(--lilac-1);
            text-decoration: none;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
        }

        .cvv-disclaimer {
            font-size: 0.8em;
            color: var(--color-danger);
        }

        /* Utilitário */
        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <div id="particles-js"></div>
    <!-- Header com Logo e Navegação -->
    <header>
        <a href="index.html" id="logo"><img class="logo" src="imgs/logoCAS.png" alt=""></a>

        <!-- Navegação Desktop -->
        <nav>
            <a href="index.html" class="nav-link text-white" data-page="1">Home</a>
            <a href="aprofundamento.html#aprof" class="nav-link text-white" data-page="2">Aprofunde</a>
            <a href="rename.html#consc" class="nav-link text-white" data-page="3">Conscientização</a>
            <a href="timeline.html#tm" class="nav-link text-white" data-page="4">Timeline</a>
            <a href="formulário.html#desab" class="nav-link text-white" data-page="5">Desabafe</a>
            <a href="Jogo.html#gojo" class="nav-link active text-white" data-page="6">Jogo</a>
            <a href="contato.html#ctt" class="nav-link text-white" data-page="7">Contato</a>
        </nav>

        <!-- Botão Menu Sanduíche (Hamburger) -->
        <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </header>

    <!-- Menu Mobile -->
    <nav class="nav-mobile" id="navMobile">
        <a href="index.html" class="nav-link  text-white" data-page="1">Home</a>
        <a href="aprofundamento.html#aprof" class="nav-link text-white" data-page="2">Aprofunde</a>
        <a href="rename.html#consc" class="nav-link text-white" data-page="3">Conscientização</a>
        <a href="timeline.html#tm" class="nav-link text-white" data-page="4">Timeline</a>
        <a href="formulário.html#desab" class="nav-link text-white" data-page="5">Desabafe</a>
        <a href="Jogo.html#gojo" class="nav-link active text-white" data-page="6">Jogo</a>
        <a href="contato.html#ctt" class="nav-link text-white" data-page="7">Contato</a>
    </nav>

    <main>
        <section class="banner img-fluid img-responsive" id="home"><img class="banner img-fluid img-responsive"
                src="imgs/BannerCAS.png" alt=""></section>
       
       
       
       
       <section id="gojo">
                <div class="areaJogo">
            <div id="game-container">
                <div id="start-screen">
                    <h1 class="titulo">O SINAL: O Despertar</h1>
                    <p>Você tem 45 segundos para navegar por um dia de sobrecarga. Suas escolhas refletem o
                        Comece a notar os sinais. Você é o jogador e o paciente.</p>
                    <button id="start-btn">INICIAR O SINAL</button>
                </div>
  
                <div id="gameplay-screen" class="hidden">
                    <div id="countdown" class="mb-4 text-lilac">Tempo: 15s</div>
                    <div id="event-area" class="event-card">
                        <p id="event-text" class="mb-4">Aguardando evento...</p>
                        <div class="options">
                            <button id="opt1-btn" class="btn btn-outline-secondary me-2"></button>
                            <button id="opt2-btn" class="btn btn-primary"></button>
                        </div>
                    </div>
                    <div id="success-message" class="alert alert-success mt-4 hidden">
                        <strong>Parabéns!</strong> Você está aprendendo a gerenciar suas emoções de forma saudável.
                    </div>
                </div>

                <div id="result-screen" class="hidden result-card">
                    <h1 id="result-title" class="titulo"></h1>
                    <p id="result-message"></p>
                    <div class="cta-area">
                        <a href="Jogo.html" class="cta-link">Saiba como quebrar o Ciclo na seção Conscientização do
                            site.</a>
                        <p class="cvv-disclaimer">Lembrete: Isso é uma simulação. Se precisar de ajuda, ligue CVV 188.
                        </p>
                    </div>
                    <button id="restart-btn"></button>
                </div>
            </div>
        </div>
        </section>
    </main>
    <footer>
        <div>
            <h4>CAS</h4>
            <p class="nav-footer">Um projeto desenvolvido para a Feira Tecnológica, promovendo reflexão e empatia.</p>
        </div>
        <div>
            <h4>Navegação</h4>

            <a href="index.html" class="nav-link nav-footer active text-white" data-page="1">Home</a>
            <a href="aprofundamento.html#aprof" class="nav-link nav-footer text-white" data-page="2">Aprofunde</a>
            <a href="rename.html#consc" class="nav-link nav-footer text-white" data-page="3">Conscientização</a>
            <a href="timeline.html#tm" class="nav-link nav-footer text-white" data-page="4">Timeline</a>
            <a href="formulário.html#desab" class="nav-link nav-footer text-white" data-page="5">Desabafe</a>
            <a href="Jogo.html#gojo" class="nav-link nav-footer text-white" data-page="6">Jogo</a>
            <a href="contato.html#ctt" class="nav-link nav-footer text-white" data-page="7">Contato</a>
            
        </div>
        <div>
            <h4>Projeto</h4>
            <ul>
                <li class="nav-footer">Desenvolvido por alunos do curso técnico</li>
                <li class="nav-footer">Inspirado na temática da autodestruição silenciosa</li>
            </ul>
        </div>
        <div>
            <h4>Integrantes</h4>
            <ul>
                <li class="nav-footer">Arthur Franco</li>
                <li class="nav-footer">Arthur Gomes</li>
                <li>Arthur Pereira</li>
                <li class="nav-footer">Bruno Ferreira</li>
                <li class="nav-footer">João Pedro</li>
            </ul>
        </div>
    </footer>

    <div class="copyright">
        © 2025 - Projeto C.A.S. | Todos os direitos reservados.
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

<script>
        (function () {
            // Scroll to top button
            const scrollToTopBtn = document.getElementById('scrollToTopBtn');
            const scrollThreshold = 100; // aparecerá após 100px de scroll

            if (scrollToTopBtn) {
                window.addEventListener('scroll', () => {
                    if (window.scrollY > scrollThreshold) {
                        scrollToTopBtn.style.opacity = '1';
                        scrollToTopBtn.style.visibility = 'visible';
                    } else {
                        scrollToTopBtn.style.opacity = '0';
                        scrollToTopBtn.style.visibility = 'hidden';
                    }
                });

                scrollToTopBtn.addEventListener('click', () => {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                });
            }

            // Hamburger menu
            const hamburger = document.getElementById('hamburger');
            const navMobile = document.getElementById('navMobile');
            const navLinks = document.querySelectorAll('.nav-link');
            const logo = document.getElementById('logo');

            if (hamburger && navMobile) {
                hamburger.addEventListener('click', (e) => {
                    e.stopPropagation();
                    hamburger.classList.toggle('active');
                    navMobile.classList.toggle('active');
                });

                navLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        // fechar menu mobile ao clicar em qualquer link
                        hamburger.classList.remove('active');
                        navMobile.classList.remove('active');
                    });
                });

                // fechar ao clicar fora
                document.addEventListener('click', (e) => {
                    if (!hamburger.contains(e.target) && !navMobile.contains(e.target)) {
                        hamburger.classList.remove('active');
                        navMobile.classList.remove('active');
                    }
                });
            }

            if (logo) {
                logo.addEventListener('click', (e) => {
                    e.preventDefault();
                    window.location.href = 'index.html';
                });
            }

            // Destacar link ativo
            const path = window.location.pathname;
            const pageName = path.substring(path.lastIndexOf('/') + 1).toLowerCase();
            const isRootOrIndex = pageName === '' || pageName === 'index.html' || pageName === 'wave-transition.html';
            const currentDataPage = isRootOrIndex ? '1' : null;

            // limpar estado inicial
            navLinks.forEach(link => link.classList.remove('active'));

            if (currentDataPage) {
                const activeLinkDesktop = document.querySelector('nav a[data-page="' + currentDataPage + '"]');
                const activeLinkMobile = document.querySelector('.nav-mobile a[data-page="' + currentDataPage + '"]');
                if (activeLinkDesktop) activeLinkDesktop.classList.add('active');
                if (activeLinkMobile) activeLinkMobile.classList.add('active');
            } else {
                // fallback: destacar por href que contenha o nome do arquivo
                navLinks.forEach(link => {
                    const href = (link.getAttribute('href') || '').toLowerCase();
                    if (pageName && href.includes(pageName)) {
                        link.classList.add('active');
                    }
                });
            }
        })();
    </script>
    <script>
        particlesJS("particles-js", {
            "particles": {
                "number": { "value": 120 },
                "color": { "value": "000000" },
                "shape": {
                    "type": "triangle",
                    "stroke": {
                        "width": 7,
                        "color": "#9599E6"
                    }
                },
                "opacity": {
                    "value": 0.8,
                    "random": true
                },
                "size": {
                    "value": 6,
                    "random": true
                },
                "move": {
                    "enable": true,
                    "speed": 1.2,
                    "direction": "none",
                    "random": true,
                    "straight": false,
                    "out_mode": "out",
                    "attract": {
                        "enable": true
                    }
                },
                "line_linked": {
                    "enable": true
                }
            },
            "interactivity": {
                "detect_on": "canvas",
                "events": {
                    "onhover": { "enable": true, "mode": "repulse" },
                    "onclick": { "enable": false }
                },
                "modes": {
                    "repulse": { "distance": 100, "duration": 1 }
                }
            },
            "retina_detect": true
        });
    </script>
    <script>
    const EM_MAX = 100;
    const DE_MAX = 100; // Limite para o estado de "Sobrecarga"

    let energiaMental = EM_MAX;
    let dividaEmocional = 0;
    let tempoRestante = 45;
    let coragemScore = 0; // Contador de escolhas positivas
    let gameInterval;
    let eventInterval;
    let gameRunning = false;

    // Elementos do DOM
    const $body = document.body;
    const $startScreen = document.getElementById('start-screen');
    const $gameplayScreen = document.getElementById('gameplay-screen');
    const $resultScreen = document.getElementById('result-screen');
    const $startBtn = document.getElementById('start-btn');
    const $restartBtn = document.getElementById('restart-btn');
    const $countdown = document.getElementById('countdown');
    const $emBar = document.getElementById('em-bar');
    const $deBar = document.getElementById('de-bar');
    const $eventArea = document.getElementById('event-area');
    const $eventText = document.getElementById('event-text');
    const $opt1Btn = document.getElementById('opt1-btn');
    const $opt2Btn = document.getElementById('opt2-btn');
    const $resultTitle = document.getElementById('result-title');
    const $resultMessage = document.getElementById('result-message');
    const $gameContainer = document.getElementById('game-container');

    // Elementos das Barras (Containers) - ESSENCIAL para mostrar/esconder
    const $emBarContainer = $emBar.closest('.resource-bar-container');
    const $deBarContainer = $deBar.closest('.resource-bar-container');


    // --- LISTA DE EVENTOS DO CICLO (FASE 1) - ADICIONADO MAIS 3 EVENTOS ---
    const events = [
        {
            text: "São 3 da manhã e você ainda está scrollando nas redes sociais.",
            opt1Label: "Só mais alguns minutos não fazem mal.",
            opt1Effect: { coragem: 0 },
            opt2Label: "Definir um alarme de sono é importante.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "Seu projeto está quase perfeito, mas você não consegue parar de revisar.",
            opt1Label: "A perfeição é necessária para o sucesso.",
            opt1Effect: { coragem: 0 },
            opt2Label: "O bom é melhor que o perfeito agora.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "Sua agenda está lotada de compromissos para a semana.",
            opt1Label: "Posso me organizar melhor e dar conta de tudo.",
            opt1Effect: { coragem: 0 },
            opt2Label: "Preciso avaliar o que é realmente prioritário.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "Você percebe que não se lembra da última vez que fez algo que gosta.",
            opt1Label: "Quando terminar meus objetivos, terei tempo.",
            opt1Effect: { coragem: 0 },
            opt2Label: "Vou reservar um momento esta semana.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "Todo mundo parece estar progredindo mais rápido que você.",
            opt1Label: "Preciso trabalhar mais para alcançá-los.",
            opt1Effect: { coragem: 0 },
            opt2Label: "Cada um tem seu próprio ritmo e história.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "Seu corpo dá sinais de cansaço no meio do dia.",
            opt1Label: "Mais um café resolve por enquanto.",
            opt1Effect: { coragem: 0 },
            opt2Label: "Uma pausa curta pode me ajudar.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "As notificações do celular não param de chegar.",
            opt1Label: "Preciso estar disponível sempre.",
            opt1Effect: { coragem: 0 },
            opt2Label: "Posso definir horários para respondê-las.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "Você se sente sobrecarregado com as expectativas dos outros.",
            opt1Label: "Não posso decepcionar ninguém.",
            opt1Effect: { coragem: 0 },
            opt2Label: "É importante estabelecer limites saudáveis.",
            opt2Effect: { coragem: 1 }
        },
        {
            text: "Final do dia: seu corpo e mente pedem uma pausa.",
            opt1Label: "Só depois que terminar mais estas tarefas.",
            opt1Effect: { coragem: 0 },
            opt2Label: "O descanso também é produtivo.",
            opt2Effect: { coragem: 1 }
        }
    ];
    let eventsPool = [];

    // --- FUNÇÕES DE LÓGICA (FASE 1) ---

    function updateBars() {
        energiaMental = Math.max(0, Math.min(EM_MAX, energiaMental));
        dividaEmocional = Math.max(0, Math.min(DE_MAX, dividaEmocional));

        $emBar.style.width = `${energiaMental}%`;
        $deBar.style.width = `${dividaEmocional}%`;

        // A lógica de SOBRECARGA é mantida
        if (dividaEmocional > 70) {
            $gameContainer.classList.add('overload');
            $body.classList.add('overload');
        } else {
            $gameContainer.classList.remove('overload');
            $body.classList.remove('overload');
        }

        if (energiaMental <= 0) {
            endGame();
        }
    }

    function handleChoice(effect) {
        if (!gameRunning) return;

        coragemScore += effect.coragem;
        questaoAtual++;

        // Reseta o tempo para a próxima questão
        tempoRestante = 15;
        $countdown.textContent = `Tempo: ${tempoRestante}s`;

        // Verifica se terminou todas as questões
        if (questaoAtual >= 5) { // Limitamos a 5 questões por jogo
            finishGame();
        } else {
            loadNewEvent();
        }
    }

    function handleTimeUp() {
        clearInterval(gameInterval);
        finishGame();
    }

    function finishGame() {
        gameRunning = false;
        clearInterval(gameInterval);

        // Calcula a porcentagem de sucesso
        const sucessoRate = (coragemScore / questaoAtual) * 100;

        if (sucessoRate >= 60) {
            // Mostra mensagem de sucesso
            document.getElementById('success-message').classList.remove('hidden');
            showResultScreen(
                "PARABÉNS! VOCÊ ESTÁ NO CAMINHO CERTO!",
                "Você demonstrou sabedoria em suas escolhas e está aprendendo a cuidar de si mesmo. Continue praticando o autocuidado e estabelecendo limites saudáveis.",
                true
            );
        } else {
            showResultScreen(
                "HORA DE REFLETIR",
                "Suas escolhas mostram que você ainda pode estar priorizando demais as expectativas externas. Lembre-se: cuidar de si não é egoísmo, é necessidade.",
                true
            );
        }
    }

    // Função auxiliar para embaralhar botões
    function shuffleButtons(btn1, btn2) {
        const parent = btn1.parentNode;
        if (Math.random() < 0.5) {
            parent.insertBefore(btn2, btn1);
        } else {
            parent.insertBefore(btn1, btn2);
        }
    }

    function loadNewEvent() {
        if (eventsPool.length === 0) {
            eventsPool = [...events];
        }

        let eventIndex;
        // Lógica para forçar o "Sinal Final"
        if (tempoRestante <= 15 || dividaEmocional > 70) {
            const finalEventIndex = eventsPool.findIndex(e => e.text.includes('Sinal Final'));
            if (finalEventIndex !== -1) {
                eventIndex = finalEventIndex;
            } else {
                eventIndex = Math.floor(Math.random() * eventsPool.length);
            }
        } else {
            // Sorteia um evento que não seja o final
            const nonFinalEvents = eventsPool.filter(e => !e.text.includes('Sinal Final'));
            if (nonFinalEvents.length > 0) {
                eventIndex = eventsPool.findIndex(e => e === nonFinalEvents[Math.floor(Math.random() * nonFinalEvents.length)]);
            } else {
                eventIndex = 0;
            }
        }

        if (eventIndex === -1 && eventsPool.length > 0) {
            eventIndex = Math.floor(Math.random() * eventsPool.length);
        }

        const event = eventsPool.splice(eventIndex, 1)[0];

        $eventText.textContent = event.text;
        $opt1Btn.textContent = event.opt1Label;
        $opt2Btn.textContent = event.opt2Label;

        // Garante que os botões tenham as classes corretas
        $opt1Btn.classList.add('sacrifice-btn');
        $opt1Btn.classList.remove('courage-btn');
        $opt2Btn.classList.add('courage-btn');
        $opt2Btn.classList.remove('sacrifice-btn');

        $opt1Btn.onclick = () => handleChoice(event.opt1Effect);
        $opt2Btn.onclick = () => handleChoice(event.opt2Effect);

        // Aleatoriza a posição dos botões a cada evento
        shuffleButtons($opt1Btn, $opt2Btn);

        $eventArea.classList.remove('hidden');
    }

    function startGame() {
        // Reset de estado
        coragemScore = 0;
        gameRunning = true;
        eventsPool = [...events];
        questaoAtual = 0;
        tempoRestante = 15;

        // Reset de visual
        $startScreen.classList.add('hidden');
        $resultScreen.classList.add('hidden');
        $gameplayScreen.classList.remove('hidden');
        document.getElementById('success-message').classList.add('hidden');

        // Esconde o botão de restart ao iniciar
        $restartBtn.style.display = 'none';

        loadNewEvent();

        // Limpa timers antigos antes de iniciar novos
        clearInterval(gameInterval);

        // Início do Timer para cada questão
        gameInterval = setInterval(() => {
            tempoRestante--;
            $countdown.textContent = `Tempo: ${tempoRestante}s`;

            if (tempoRestante <= 0) {
                handleTimeUp();
            }
        }, 1000);

        // Início do Timer dos Eventos
        eventInterval = setInterval(() => {
            if ($eventArea.classList.contains('hidden') && gameRunning && tempoRestante > 0) {
                loadNewEvent();
            }
        }, 6000);
    }

    function endGame() {
        // Chamado quando EM chega a 0
        gameRunning = false;
        clearInterval(gameInterval);
        clearInterval(eventInterval);

        // Garante que as barras continuam escondidas após o colapso
        $emBarContainer.classList.add('hidden');
        $deBarContainer.classList.add('hidden');

        // Resultado imediato de COLAPSO
        showResultScreen("COLAPSO: VOCÊ QUEBROU.",
            "Você viu o peso de ignorar os sinais. Essa simulação pode ser sua realidade. A autodestruição silenciosa não tem Game Over. A busca por ajuda é o seu reset.",
            true); // Colapso: mostra o restart
    }

    // --- LÓGICA DA FASE 2: O SINAL NO OUTRO - ADICIONADO MAIS 1 EVENTO ---

    const phase2Events = [
        {
            text: "Um amigo te evita e parece exausto há semanas. Você percebeu um SINAL. Qual é a coragem do apoio?",
            opt1Label: "Não se intrometer. 'Ele vai falar se precisar.'",
            opt1Action: { message: "Você deixou o medo vencer. O ciclo no outro continua. Lembre-se: Coragem também é estender a mão.", success: false },
            opt2Label: "Perguntar com empatia: 'Tudo bem? Estou aqui.'",
            opt2Action: { message: "A empatia é a chave! Você quebrou o ciclo do isolamento por ele. O primeiro passo é a escuta.", success: true }
        },
        {
            text: "Seu colega de trabalho está visivelmente irritado e cometeu erros. Você suspeita do Ciclo. O que fazer?",
            opt1Label: "Ignorar e focar apenas no seu trabalho.",
            opt1Action: { message: "Você não agiu. O colega pode estar sobrecarregado. Sua coragem de se aproximar faz a diferença.", success: false },
            opt2Label: "Sugira que ele tire uma pausa e ofereça apoio para conversar com o RH/chefe.",
            opt2Action: { message: "Apoio prático e respeitoso. Você validou o sofrimento dele e indicou um caminho. Isso é coragem.", success: true }
        },
        // --- NOVO EVENTO DE FASE 2 INSERIDO ---
        {
            text: "Você vê um post de um conhecido que parece um 'grito de ajuda' velado. O que fazer?",
            opt1Label: "Assumir que é 'drama' de rede social e seguir rolando o feed.",
            opt1Action: { message: "Omissão por conveniência. O isolamento começa com a inação dos próximos. Coragem é a atitude de checagem, mesmo no digital.", success: false },
            opt2Label: "Chamar no privado com gentileza: 'Vi seu post. Está tudo bem?'",
            opt2Action: { message: "Você estendeu a mão na rede. A coragem de invadir o silêncio com gentileza é o primeiro socorro emocional.", success: true }
        }
    ];

    function showPhase2Screen() {
        $gameplayScreen.classList.add('hidden');
        $eventArea.classList.remove('hidden'); // Reutiliza a área de evento para a Fase 2

        const event = phase2Events[Math.floor(Math.random() * phase2Events.length)];

        $countdown.textContent = "REFLEXÃO FINAL: O SINAL NO OUTRO";
        $eventText.textContent = event.text;
        $opt1Btn.textContent = event.opt1Label;
        $opt2Btn.textContent = event.opt2Label;

        // Configura os ouvintes para a Fase 2, que levam diretamente ao resultado final
        $opt1Btn.onclick = () => showFinalResult(event.opt1Action);
        $opt2Btn.onclick = () => showFinalResult(event.opt2Action);

        // Garante que os botões tenham as classes corretas
        $opt1Btn.classList.add('sacrifice-btn');
        $opt1Btn.classList.remove('courage-btn');
        $opt2Btn.classList.add('courage-btn');
        $opt2Btn.classList.remove('sacrifice-btn');

        // Aleatoriza a posição dos botões na Fase 2 também
        shuffleButtons($opt1Btn, $opt2Btn);
    }

    function showFinalResult(action) {
        let finalTitle = "";
        let finalMessage = "";
        let finalCoragemScore = coragemScore + (action.success ? 3 : 0); // Adiciona +3 por um final corajoso

        $eventArea.classList.add('hidden');

        // Lógica de Resultado Pós-Fase 2 (Reflexão Total)
        if (finalCoragemScore >= 8) { // Alto score total
            finalTitle = "VITÓRIA: CORAGEM PLENA E EMPATIA ATIVA.";
            finalMessage = `Você demonstrou coragem por si mesmo (pontuação na Fase 1: ${coragemScore}) e agiu com empatia pelo próximo. Quebrar o ciclo requer auto-cuidado E estender a mão. Leve essa lição para sua rotina.`;
        } else if (finalCoragemScore >= 5) { // Score médio
            finalTitle = "DESPERTAR: VOCÊ RECONHECEU OS SINAIS.";
            finalMessage = `Você começou a colocar limites, mas ainda hesitou em alguns momentos ou ao ajudar o próximo. A vulnerabilidade é uma força. Continue cultivando a coragem de pedir e oferecer ajuda.`;
        } else { // Score baixo
            finalTitle = "ALERTA: O RISCO DO SILÊNCIO CONTINUA.";
            finalMessage = `Você evitou o colapso por pouco, mas as escolhas de sacrifício e isolamento prevaleceram. O medo da vergonha é real. Sua missão agora é encontrar a coragem de pedir ajuda e não hesitar em oferecer suporte.`;
        }

        // Inclui a mensagem específica da Fase 2 (Ato de Coragem) no final
        finalMessage += `<br><br><strong>Ato de Coragem:</strong> ${action.message}`;

        showResultScreen(finalTitle, finalMessage, true); // Mantenha TRUE para mostrar o restart
    }


    function showResultScreen(title, message, showRestart) {
        $gameplayScreen.classList.add('hidden');
        $eventArea.classList.add('hidden');
        $resultScreen.classList.remove('hidden');

        $resultTitle.textContent = title;
        $resultMessage.innerHTML = message; // Usando innerHTML para aceitar as tags <br> e <strong>

        // Garante que o botão de reiniciar esteja visível (Lógica de restart)
        $restartBtn.textContent = 'REINICIAR O SINAL';
        document.getElementById('restart-btn').style.display = showRestart ? 'block' : 'none';
    }

    // --- INICIALIZAÇÃO ---
    $startBtn.addEventListener('click', startGame);
    $restartBtn.addEventListener('click', startGame);

    updateBars();
</script>
    <script src="bootstrap-5.3.8-dist/js/bootstrap.bundle.js"></script>

</body>

</html>